<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Library BXU</title>
    <link rel="icon" href="./img/logo.png" type="image/png">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@100;600;800&display=swap"
        rel="stylesheet">
    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">


    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <link href="./css/mycss.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css"
        integrity="sha512-9xKTRVabjVeZmc+GUW8GgSmcREDunMM+Dt/GrzchfN8tkwHizc5RP4Ok/MXFFy5rIjJjzhndFScTceq5e6GvVQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Основные улучшения дизайна */
        :root {
            --primary: #0d6efd;
            --primary-dark: #0a58ca;
            --secondary: #6c757d;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #198754;
            --warning: #ffc107;
            --danger: #dc3545;
            --bxu-blue: #1a4b8c;
            --bxu-gold: #d4af37;
        }

        /* Общие стили */
        body {
            font-family: 'Open Sans', sans-serif;
            color: #333;
            line-height: 1.6;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Raleway', sans-serif;
            font-weight: 700;
        }

        /* Улучшенный верхний бар */
        .topbar {
            background: linear-gradient(90deg, var(--bxu-blue) 0%, #2c6db3 100%) !important;
            padding: 8px 0;
        }

        .topbar-top {
            align-items: center;
        }

        #note a p {
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        #note a p:hover {
            color: var(--bxu-gold) !important;
            transform: translateY(-2px);
        }

        .icon a i {
            transition: all 0.3s ease;
            font-size: 1.2rem;
            color: #dee2e6 !important;
        }

        .icon a:hover i {
            color: #0d6efd(111, 111, 255) !important;
            transform: scale(1.2);
        }

        /* Навигационная панель */
        .navbar {
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            padding: 0;
        }

        .navbar-light .navbar-nav .nav-link {
            color: var(--dark);
            font-weight: 600;
            padding: 1rem 1.2rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .navbar-light .navbar-nav .nav-link:hover,
        .navbar-light .navbar-nav .nav-link.active {
            color: var(--primary);
        }

        .navbar-light .navbar-nav .nav-link:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: var(--primary);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .navbar-light .navbar-nav .nav-link:hover:after,
        .navbar-light .navbar-nav .nav-link.active:after {
            width: 70%;
        }

        .navbar-toggler {
            border: none;
            padding: 0.5rem;
        }

        /* Герой секция */
        .my-text {
            background: linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9)),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill-opacity="0.05" fill="%23000" width="50" height="50"/><rect fill-opacity="0.05" fill="%23000" x="50" y="50" width="50" height="50"/></svg>');
            background-size: cover;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        .my-text h1 {
            color: var(--bxu-blue);
            font-weight: 800;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 1rem;
        }

        .my-text h1:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 4px;
            background: var(--bxu-gold);
            border-radius: 2px;
        }

        .my-text p {
            color: #444;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        /* Стили для выпадающих меню */
        /* .myBgForMenuFather {
            background-color: grey;
            border: 2px solid #e9ecef;
            border-radius: 8px !important;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            font-weight: 500;
        }

        .myBgForMenuFather:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
        }

        .myBgForMenuFather option {
            padding: 12px;
        } */

        /* Карточки и изображения */
        .img-zoomin {
            transition: transform 0.5s ease;
            border-radius: 8px;
        }

        .img-zoomin:hover {
            transform: scale(1.03);
        }

        .bg-light {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 3px rgba(0, 0, 0, 0.05);
        }

        /* Секции с книгами */
        .latest-news,
        .populer-news {
            background: linear-gradient(to bottom, #f9fafb, #fff);
            padding: 4rem 0;
        }

        .latest-news h2,
        .populer-news h4 {
            color: var(--bxu-blue);
            position: relative;
            padding-bottom: 1rem;
            font-weight: 800;
        }

        .latest-news h2:after,
        .populer-news h4:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--bxu-gold);
            border-radius: 2px;
        }

        /* Таблица */
        .table th {
            background: linear-gradient(90deg, var(--bxu-blue) 0%, #2c6db3 100%) !important;
            color: white;
            vertical-align: middle;
            padding: 1rem 0.75rem;
        }

        .table td {
            vertical-align: middle;
            padding: 0.75rem;
        }

        .table-hover tbody tr:hover {
            background-color: rgba(26, 75, 140, 0.05);
        }

        /* Кнопки */
        .btn-primary {
            background: linear-gradient(90deg, var(--bxu-blue) 0%, #2c6db3 100%);
            border: none;
            border-radius: 6px;
            padding: 0.6rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: linear-gradient(90deg, #153e7a 0%, #235a9e 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 75, 140, 0.3);
        }

        /* Пагинация */
        .page-link {
            color: var(--bxu-blue);
            border: 1px solid #dee2e6;
            border-radius: 6px;
            margin: 0 3px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .page-link:hover {
            color: white;
            background-color: var(--bxu-blue);
            border-color: var(--bxu-blue);
        }

        .page-item.active .page-link {
            background: linear-gradient(90deg, var(--bxu-blue) 0%, #2c6db3 100%);
            border-color: var(--bxu-blue);
        }

        /* Формы */
        .form-control {
            border-radius: 6px;
            padding: 0.75rem 1rem;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
        }

        /* Футер */
        .footer {
            background: linear-gradient(90deg, var(--bxu-blue) 0%, #1e5bac 100%) !important;
            color: white;
        }

        .footer .text-secondary {
            color: rgba(255, 255, 255, 0.8) !important;
        }

        .footer .btn-light {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.3s ease;
        }

        .footer .btn-light:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .copyright {
            background: rgba(0, 0, 0, 0.2) !important;
        }

        /* Анимации */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadein {
            animation: fadeIn 0.8s ease forwards;
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .navbar-light .navbar-nav .nav-link {
                padding: 0.8rem 1rem;
            }

            .my-text h1 {
                font-size: 1.8rem;
            }

            .my-text p {
                font-size: 1rem;
            }

            .d-flex.flex-wrap.gap-4 {
                justify-content: center !important;
            }

            .form-select {
                width: 100% !important;
                margin-bottom: 1rem;
            }
        }
    </style>

</head>

<body>

    <!-- Spinner Start -->
    <div id="spinner"
        class="show w-100 vh-100 bg-white position-fixed translate-middle top-50 start-50  d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" role="status"></div>
    </div>
    <!-- Spinner End -->


    <!-- Navbar start -->
    <div class="container-fluid sticky-top px-0">
        <div class="container-fluid topbar bg-dark d-none d-lg-block">
            <div class="container px-0">
                <div class="topbar-top d-flex justify-content-between flex-lg-wrap">
                    <div class="top-info flex-grow-0">
                        <div class="overflow-hidden" style="width: 835px;">
                            <div id="note" class="ps-2">
                                <img src="./img/logo.png"
                                    class="img-fluid rounded-circle border border-3 border-primary me-2"
                                    style="width: 30px; height: 30px;" alt="">
                                <a href="#">
                                    <p class="text-white mb-0 link-hover">Buxoro Xalqaro Universiteti
                                        elektron kutubxonasi</p>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="top-link flex-lg-wrap">


                        <div class="d-flex icon">
                            <p class="mb-0 text-white me-2">Ijtimoiy tarmoqlar:</p>
                            <a href="https://www.facebook.com/buxpxti.uz" class="me-2"><i
                                    class="fab fa-facebook-f text-body link-hover"></i></a>
                            <a href="https://www.instagram.com/buxpxti.uz" class="me-2"><i
                                    class="fab fa-instagram text-body link-hover"></i></a>
                            <a href="https://www.youtube.com/@buxpxti" class="me-2"><i
                                    class="fab fa-youtube text-body link-hover"></i></a>
                            <a href="https://t.me/BuxPXTI_uz" class="me-2"><i
                                    class="fab fa-telegram text-body link-hover"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid bg-light">
            <div class="container px-0">
                <nav class="navbar navbar-light navbar-expand-xl">
                    <a href="index.html" class="navbar-brand mt-3">
                        <p class="text-primary display-6 mb-2" style="line-height: 0;">
                            <img style="width: 180px" class=" d-flex " src="./img/bxu.png">
                        </p>
                    </a>
                    <button class="navbar-toggler py-2 px-3" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarCollapse">
                        <span class="fa fa-bars text-primary"></span>
                    </button>
                    <div class="collapse navbar-collapse bg-light py-3" id="navbarCollapse">
                        <div class="navbar-nav mx-auto border-top">
                            <a href="index.html" class="nav-item nav-link active">Bosh sahifa</a>
                            <a href="#table-books" class="nav-item nav-link">Fan dasturlari bo'yicha</a>
                            <a href="#yonalish" class="nav-item nav-link">Yo'nalishlar</a>
                            <a href="#badiiy" class="nav-item nav-link">Badiiy Adabiyotlar</a>
                            <a href="#audio" class="nav-item nav-link">Audio Adabiyotlar</a>
                            <!--                                <a href="index.html" class="nav-item nav-link active">Home</a>-->
                            <!--                                <a href="detail-page.html" class="nav-item nav-link">Detail  Page</a>-->
                            <!--                                <a href="404.html" class="nav-item nav-link">404 Page</a>-->
                            <!--                                <div class="nav-item dropdown">-->
                            <!--                                    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Dropdown</a>-->
                            <!--                                    <div class="dropdown-menu m-0 bg-secondary rounded-0">-->
                            <!--                                        <a href="#" class="dropdown-item">Dropdown 1</a>-->
                            <!--                                        <a href="#" class="dropdown-item">Dropdown 2</a>-->
                            <!--                                        <a href="#" class="dropdown-item">Dropdown 3</a>-->
                            <!--                                        <a href="#" class="dropdown-item">Dropdown 4</a>-->
                            <!--                                    </div>-->
                            <!--                                </div>-->
                            <!--                                <a href="contact.html" class="nav-item nav-link">Contact Us</a>-->
                        </div>
                        <div class="d-flex flex-nowrap border-top pt-3 pt-xl-0">
                            <div class="input-group w-100 mx-auto d-flex ">
                                <!--                                    <input type="search" class="form-control p-1" placeholder="Qidiruv.." aria-describedby="search-icon-1">-->
                                <!--                                    <span id="search-icon-1" class="btn btn-primary input-group-text p-2"><i class="fa fa-search text-white"></i></span>-->
                            </div>
                            <!--                                <button class="btn-search btn border border-primary btn-md-square rounded-circle bg-white my-auto" data-bs-toggle="modal" data-bs-target="#searchModal"><i class="fas fa-search text-primary"></i></button>-->
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <!-- Navbar End -->


    <!-- Modal Login Start -->
    <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content rounded-0">
                <div class="modal-header text-center">
                    <h5 class="modal-title" id="exampleModalLabel">
                        Kitobni yuklab olish uchun HEMIS Student axborot tizimi login parolini kiriting.
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex align-items-center">
                    <div class="input-group w-75 mx-auto d-flex">
                        <div class="w-100 text-center">
                            <h5 class="modal-title " id="exampleModalLabel">
                                Buxoro Xalqaro Universiteti
                                elektron kutubxonasi
                            </h5>
                            <p>HEMIS Student axborot tizimidagi login parolini kiriting</p>
                        </div>
                        <div class="m-auto w-75 my-2">
                            <form id="studentLoginForm" onsubmit="handleStudentSubmit(event)">
                                <div class="row g-4">
                                    <div class="w-75 m-auto">
                                        <div class="my-2">
                                            <input type="text" id="studentLogin"
                                                class="w-100 form-control border-0 py-3" name="name"
                                                placeholder="Talaba ID" required />
                                        </div>
                                        <div class="my-4">
                                            <input type="password" id="studentPassword"
                                                class="w-100 form-control border-0 py-3" name="password"
                                                placeholder="Parol" required />
                                        </div>
                                    </div>
                                    <div class="col-6 d-flex gap-4 m-auto">
                                        <button class="w-50 btn btn-primary form-control py-3" type="submit">
                                            Kirish
                                        </button>
                                        <button type="button" data-bs-dismiss="modal" aria-label="Close"
                                            class="w-50 btn btn-danger form-control py-3 text-dark">
                                            Bekor qilish
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Login End -->





    <!-- Barcha selectlar Start -->

    <div class="container-fluid ">
        <div class="container py-5">
            <div class="row g-4">
                <div class="col-lg-7 col-xl-8 mt-0 bg-image p-0 border-4 border-danger      ">

                    <div class="p-2 my-text h-100 ">
                        <h1 class="fw-bold p-5 pb-0 fs-1 fs-lg-2 fs-xl-1 fs-md-3 fs-sm-4">
                            Buxoro Xalqaro Universiteti
                            elektron kutubxonasi
                        </h1>
                        <p class="p-4 fs-4 text-dark">
                            Ushbu sahifa Buxoro Xalqaro Universiteti
                            talabalari uchun ta'lim olish
                            jarayonlarida mavjud fanlar bo'yicha barcha elaktron kitoblarni olish uchun qo'shimcha
                            imkoniyatlar yaratish uchun xizmat qiladi.
                        </p>

                        <div class="d-flex flex-wrap gap-4 justify-content-evenly">

                            <div>
                                <select id="educationType" class="form-select myBgForMenuFather"
                                    style="width: 190px; height: 50px;">
                                    <option
                                        style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;"
                                        value="" disabled selected>Ta'lim turini tanlang</option>
                                    <option
                                        style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;"
                                        value="1">Bakalavr</option>
                                    <option
                                        style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;"
                                        value="2">Magistr</option>
                                </select>
                            </div>
                            <div>
                                <select id="faculty" class="form-select myBgForMenuFather"
                                    style="width: 250px; height: 50px;" disabled>
                                    <option value="" disabled selected>Yo'nalishingizni tanlang</option>
                                </select>
                            </div>
                            <div>
                                <select id="subjects" class="form-select myBgForMenuFather"
                                    style="width: 250px; height: 50px;" disabled>
                                    <option class="text-dark" value="" disabled selected>Fanni tanlang</option>
                                </select>
                            </div>

                        </div>

                    </div>

                </div>
                <div class="col-lg-5 col-xl-4">
                    <div class="bg-light rounded p-4 pt-0">
                        <div class="row g-4">
                            <div class="col-12">
                                <div class="rounded overflow-hidden">
                                    <img src="/api/v1/image/library1.jpg" class="img-fluid rounded img-zoomin w-100"
                                        alt="" />
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="d-flex flex-column">
                                    <h4 class="h4 mb-2">AXBOROT-RESURS MARKAZI.</h4>

                                </div>
                            </div>
                            <div class="col-12">
                                <div class="row g-4 align-items-center">
                                    <div class="col-5">
                                        <div class="overflow-hidden rounded">
                                            <img src="/api/v1/image/library3.jpg"
                                                class="img-zoomin img-fluid rounded w-100" alt="">
                                        </div>
                                    </div>
                                    <div class="col-7">
                                        <div class="features-content d-flex flex-column">
                                            <a href="#" class="h6"> ALISHER NAVOIY NOMIDAGI O'ZBEKISTON MILLIY
                                                KUTUBXONASI FILIALI</a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="row g-4 align-items-center">
                                    <div class="col-5">
                                        <div class="overflow-hidden rounded">
                                            <img src="/api/v1/image/library2.jpg"
                                                class="img-zoomin img-fluid rounded w-100" alt="">
                                        </div>
                                    </div>
                                    <div class="col-7">
                                        <div class="features-content d-flex flex-column">
                                            <a href="#" class="h6"> Elektron kutubxonada oliy ta'lim o'quv adabiyotlari
                                                va ilmiy maqolalari jamlangan</a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Post Section End -->

    <div id="selected_books" class="row m-4">


    </div>




    <!-- Yo'nalish bo'yicha -->
    <div id="yonalish" class="container-fluid latest-news ">
        <div class="container ">
            <h2 class="mb-4">Yo'nalishlar bo'yicha</h2>
            <div id="all1-faculties">
                <div id="all-faculties" class="latest-news-carousel owl-carousel">


                </div>
            </div>

        </div>
    </div>
    <!-- Yo'nalish bo'yicha End -->

    <!-- Yo'nalish bo'yicha fanlar Start -->
    <div id="faculty-specific" class="d-none">
        <div class="container-fluid ">
            <div class="container py-2">

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="mb-4">
                            <h4 id="faculty_name" class="h2">${facuty.name}</h4>
                        </div>
                        <div class="position-relative rounded overflow-hidden mb-3">

                        </div>

                        <div id="selected-subject-books" class="row g-4">
                            <div>
                                <p>Fanni tanlang</p>
                            </div>

                        </div>

                    </div>
                    <div class="col-lg-4">
                        <div class="row g-4">
                            <div class="col-12">
                                <div class="p-3 rounded border">
                                    <div class="input-group w-100 mx-auto d-flex mb-4">
                                        <input type="search" id="subject-search" class="form-control p-3"
                                            placeholder="Fan qidiruv" aria-describedby="search-icon-1"
                                            oninput="searchSubjects(this.value)">
                                        <span id="search-icon-1" class="btn btn-primary input-group-text p-3"><i
                                                class="fa fa-search text-white"></i></span>
                                    </div>
                                    <h4 class="mb-4">Mavjud fanlar</h4>
                                    <div id="faculty-selected-subject" class="row g-2">


                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Yo'nalish bo'yicha fanlar End -->
    <div class="my-4"></div>





    <!--badiiy-->
    <div class="container-fluid latest-news py-8">
        <div class="container">
            <h2 class="mb-4">Badiiy Adabiyotlar</h2>

            <!-- Input fields for book name and author -->
            <div class="input-group w-100 mx-auto d-flex mb-4">
                <input type="search" id="book-name-search" class="form-control p-3"
                    placeholder="Kitob nomini bo'yicha qidirish" aria-describedby="search-icon-1"
                    onchange="searchBooks()">

                <input type="search" id="book-author-search" class="form-control p-3"
                    placeholder="Muallifni bo'yicha qidirish" aria-describedby="search-icon-2" onchange="searchBooks()">
            </div>



            <div id="badiiy" class="row">
                <!-- Content will be injected here -->
            </div>

            <div id="badiiy-pagination" class="d-flex justify-content-center my-4">
                <!-- Pagination buttons will appear here -->
            </div>
        </div>
    </div>


    <!--Audio-->
    <div class="container-fluid latest-news py-8">
        <div class="container">
            <h2 class="mb-4">Audio Adabiyotlar</h2>

            <!-- Input fields for book name and author -->
            <div class="input-group w-100 mx-auto d-flex mb-4">
                <input type="search" id="audio-name-search" class="form-control p-3"
                    placeholder="Kitob nomini bo'yicha qidirish" aria-describedby="search-icon-1"
                    onchange="searchAudioBooks()">

                <input type="search" id="audio-author-search" class="form-control p-3"
                    placeholder="Muallifni bo'yicha qidirish" aria-describedby="search-icon-2"
                    onchange="searchAudioBooks()">
            </div>



            <div id="audio" class="row">
                <!-- Content will be injected here -->
            </div>

            <div id="audio-pagination" class="d-flex justify-content-center my-4">
                <!-- Pagination buttons will appear here -->
            </div>
        </div>
    </div>



    <!-- All books table start -->
    <div id="table-books" class="container-fluid populer-news py-5 w-100 overflow-scroll">
        <div class="container py-5">
            <div class="mb-4">
                <h4 id="faculty_name" class="h2">Fan dasturlari bo'yicha adabiyotlar</h4>
            </div>
            <!-- Responsive table wrapper -->
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">№</th>
                            <th scope="col">
                                Kitob nomi
                                <input type="search" id="book-name" class="form-control form-control-sm mt-2"
                                    placeholder="Kitob nomi..">
                            </th>
                            <th scope="col">
                                Muallif
                                <input type="search" id="book-author" class="form-control form-control-sm mt-2"
                                    placeholder="Kitob muallifi..">
                            </th>
                            <th scope="col">
                                Nashriyot
                                <input type="search" id="book-publisher" class="form-control form-control-sm mt-2"
                                    placeholder="Nashriyot..">
                            </th>
                            <th scope="col">
                                Fan
                                <div style="height: 40px;"></div>
                            </th>
                            <th scope="col">Harakatlar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows go here -->
                    </tbody>
                </table>
            </div>
            <div id="pagination-controls" class="mt-3">
                <!-- Pagination controls go here -->
            </div>
        </div>
    </div>
    <!-- All books table End -->








    <!-- Footer Start -->
    <div class="container-fluid bg-dark footer py-5">
        <div class="container ">

            <div class="row g-5">
                <div class="col-lg-12 col-xl-6">
                    <div class="footer-item-1">
                        <p class="text-secondary line-h">Manzil: <span class="text-white">Buxoro shahri Sitorayi
                                Mohi-Xosa MFY G'ijduvon ko'chasi 250-uy</span></p>
                        <p class="text-secondary line-h">Telefon: <span class="text-white">+998 55 309-99-99</span></p>
                        <div class="d-flex line-h">

                            <a href="https://www.facebook.com/buxpxti.uz"
                                class="btn btn-light me-2 btn-md-square rounded-circle"><i
                                    class="fab fa-facebook-f text-body link-hover"></i></a>
                            <a href="https://www.instagram.com/buxpxti.uz"
                                class="btn btn-light me-2 btn-md-square rounded-circle"><i
                                    class="fab fa-instagram text-body link-hover"></i></a>
                            <a href="https://www.youtube.com/@buxpxti"
                                class="btn btn-light me-2 btn-md-square rounded-circle"><i
                                    class="fab fa-youtube text-body link-hover"></i></a>
                            <a href="https://t.me/BuxPXTI_uz" class="btn btn-light me-2 btn-md-square rounded-circle"><i
                                    class="fab fa-telegram text-body link-hover"></i></a>

                        </div>
                    </div>
                </div>

                <div class="col-lg-6 col-xl-3">
                </div>

            </div>
        </div>
    </div>
    <!-- Footer End -->


    <!-- Copyright Start -->
    <div class="container-fluid copyright bg-dark py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <span class="text-light"><a href="#"><i class="fas fa-copyright text-light me-2"></i></a>BXU</span>
                </div>

            </div>
        </div>
    </div>
    <!-- Copyright End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary border-2 border-white rounded-circle back-to-top"><i
            class="fa fa-arrow-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Your JavaScript Code -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Your JavaScript Code -->
    <!--Buxoro psixologiya va xorijiy tillar institut-->
    <script>
        const baseUrl = "http://localhost:8080";
        // const baseUrl = "https://library.buxpxti.uz";
        const educationTypeSelect = document.getElementById("educationType");
        const facultySelect = document.getElementById("faculty");
        const subjectsSelect = document.getElementById("subjects");
        const selectedBooksDiv = document.getElementById("selected_books"); // Get the div for displaying books

        // Listen for education type selection
        educationTypeSelect.addEventListener("change", async () => {
            const educationType = educationTypeSelect.value;
            if (educationType) {
                try {
                    const response = await axios.get(`${baseUrl}/api/v1/faculty/${educationType}`, {
                        headers: {
                            Authorization: localStorage.getItem("access_token") || ""
                        }
                    });

                    if (response.data && Array.isArray(response.data)) {
                        facultySelect.innerHTML = `<option style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;"  value="" disabled selected>Yo'nalishingizni tanlang</option>`;
                        response.data.forEach(faculty => {
                            const option = document.createElement("option");
                            option.value = faculty.id;
                            option.style.borderRadius = "25px";
                            option.style.width = "200px";
                            option.style.color = "#0a0a0a";
                            option.style.backgroundColor = "rgba(255,255,255)";
                            option.textContent = faculty.name;
                            facultySelect.appendChild(option);
                        });

                        facultySelect.disabled = false;
                        subjectsSelect.disabled = true;
                        subjectsSelect.innerHTML = '<option style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;" value="" disabled selected>Fanni tanlang</option>';
                    }
                } catch (error) {
                    console.error("Error fetching faculties:", error);
                }
            }
        });

        // Listen for faculty selection
        facultySelect.addEventListener("change", async () => {
            const facultyId = facultySelect.value;

            if (facultyId) {
                try {
                    const response = await axios.get(`${baseUrl}/api/v1/faculty-subject/${facultyId}`, {
                        headers: {
                            Authorization: localStorage.getItem("access_token") || ""
                        }
                    });

                    if (response.data && Array.isArray(response.data)) {
                        subjectsSelect.innerHTML = '<option style="border-radius: 25px; width: 200px; background-color: rgba(255,255,255); height: 40px; color: #0a0a0a;" value="" disabled selected>Fanni tanlang</option>';
                        response.data.forEach(subject => {
                            const option = document.createElement("option");
                            option.value = subject?.subject.id;
                            option.textContent = subject?.subject.name;
                            option.style.borderRadius = "25px";
                            option.style.width = "200px";
                            option.style.color = "#0a0a0a";
                            option.style.backgroundColor = "rgba(255,255,255)";
                            subjectsSelect.appendChild(option);
                        });

                        subjectsSelect.disabled = false;
                    }
                } catch (error) {
                    console.error("Error fetching subjects:", error);
                }
            }
        });

        // Listen for subject selection
        subjectsSelect.addEventListener("change", async () => {
            const subjectId = subjectsSelect.value;

            if (subjectId) {
                try {
                    const response = await axios.get(`${baseUrl}/api/v1/book/${subjectId}`, {
                        headers: {
                            Authorization: localStorage.getItem("access_token") || ""
                        }
                    });
                    console.log(response.data)
                    if (response.data && Array.isArray(response.data)) {
                        selectedBooksDiv.innerHTML = ""; // Clear existing books

                        response.data.forEach(book => {
                            // Create a new div element
                            const bookCard = document.createElement("div");
                            bookCard.classList = "col-lg-3 col-xl-3 col-md-6 col-sm-12 my-2 "
                            bookCard.style.height = "360px";
                            bookCard.innerHTML = `
              <div style="height: 340px" class="bg-light  py-1">
                <div style="border-radius: 10px; width: 200px; height: 160px; " class="  border-3 m-auto overflow-hidden  d-flex justify-content-center">


                <img style="width: 200px; height: 160px;" src="./img/newbook.jpg">
<!--                    <i class="fa fa-book fa-5x img-fluid rounded-top m-auto " ></i>-->
                </div>
                <div class="d-flex flex-column p-4 pt-1 pb-0">
                    <a href="#" class="h5">${book.name}</a>
                    <br>
                    <div class=" justify-content-between">
                        <a href="#" class="small text-body link-hover"> <i class="fa fa-user" > </i>${book.author}</a>
                        <small class="text-body d-block"><i class="fas fa-calendar-alt me-1"> </i>  ${book.publisher}</small>
                    </div>
                    <div class="d-flex justify-content-between">
                                    <button  onclick="handleDownload({id: '${book.id}'})"  class="small text-body link-hover border-0 "> <i class="fa fa-download"> </i>yuklab olish</button>
                     </div>
                </div>
            </div>
        `;
                            selectedBooksDiv.appendChild(bookCard); // Append the created element
                        });
                    }

                } catch (error) {
                    console.error("Error fetching books:", error);
                }
            }
        });
    </script>


    <!---->
    <script>
        // Global variable to store all subjects for the selected faculty
        let allSubjects = [];

        // Fetch and render faculties
        async function fetchAndRenderFaculties() {
            try {
                const response = await axios.get(`${baseUrl}/api/v1/faculty/1`, {
                    headers: {
                        Authorization: localStorage.getItem("access_token") || ""
                    }
                });
                const faculties = response.data;
                const facultiesContainer = document.getElementById("all-faculties");
                facultiesContainer.innerHTML = "";

                faculties.forEach(faculty => {
                    const facultyHtml = `
                        <div class="latest-news-item" onclick="showFacultyDetails(${faculty.id}, '${faculty.name}')">
                            <div style="height: 380px" class="bg-light rounded">
                                <div class="rounded-top overflow-hidden p-2 d-flex justify-content-center">
                                    <img src="./img/logo.png" class="img-fluid rounded-top w-75" alt="">
                                </div>
                                <div class="d-flex flex-column p-4">
                                    <h6 class="h6">${faculty.name}</h6>
                                    <br>
                                    <div class="d-flex justify-content-between">
                                        <p class="small text-body link-hover">Yo'nalish kodi:</p>
                                        <small class="text-body d-block"><i class="fas fa-calendar-alt me-1"></i> ${faculty.code}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    facultiesContainer.innerHTML += facultyHtml;
                });

                initializeOwlCarousel();
            } catch (error) {
                console.error("Error fetching faculties:", error);
            }
        }

        // Show faculty-specific details
        async function showFacultyDetails(facultyId, facultyName) {
            try {
                // Show the faculty-specific section
                document.getElementById("faculty-specific").classList.remove("d-none");

                // Update faculty name
                document.getElementById("faculty_name").innerText = facultyName;

                // Clear books section when faculty changes
                const booksContainer = document.getElementById("selected-subject-books");
                booksContainer.innerHTML = ""; // Clear all books

                // Fetch and store subjects
                const response = await axios.get(`${baseUrl}/api/v1/faculty-subject/${facultyId}`, {
                    headers: {
                        Authorization: localStorage.getItem("access_token") || ""
                    }
                });

                allSubjects = response.data; // Store all subjects globally
                renderSubjects(allSubjects); // Render subjects
            } catch (error) {
                console.error("Error fetching subjects:", error);
            }
        }

        // Keep track of the currently selected subject
        let selectedSubjectId = null;

        // Render subjects dynamically
        function renderSubjects(subjects) {
            const subjectsContainer = document.getElementById("faculty-selected-subject");
            subjectsContainer.innerHTML = "";

            if (subjects.length === 0) {
                subjectsContainer.innerHTML = `<p>No subjects found</p>`;
                return;
            }

            subjects.forEach(subject => {
                const isSelected = subject?.subject.id === selectedSubjectId;
                const subjectHtml = `
                <div class="col-12">
                    <p class="link-hover btn w-100 rounded text-uppercase py-3
                              ${isSelected ? 'btn-primary text-white' : 'btn-light text-dark'}"
                       onclick="selectSubject(${subject?.subject.id})">
                        ${subject?.subject.name}
                    </p>
                </div>
            `;
                subjectsContainer.innerHTML += subjectHtml;
            });
        }

        // Handle subject selection
        function selectSubject(subjectId) {
            selectedSubjectId = subjectId; // Update selected subject
            renderSubjects(allSubjects);  // Re-render subjects to apply styles
            fetchBooks(subjectId);        // Fetch books for the selected subject
        }

        // Search subjects by name
        function searchSubjects(query) {
            const filteredSubjects = allSubjects.filter(subject =>
                subject?.subject?.name.toLowerCase().includes(query.toLowerCase())
            );
            renderSubjects(filteredSubjects); // Re-render with filtered results
        }

        // Fetch and render books for a selected subject
        async function fetchBooks(subjectId) {
            try {
                const response = await axios.get(`${baseUrl}/api/v1/book/${subjectId}`, {
                    headers: {
                        Authorization: localStorage.getItem("access_token") || ""
                    }
                });

                const books = response.data;
                const booksContainer = document.getElementById("selected-subject-books");
                booksContainer.innerHTML = "";

                books.forEach(book => {
                    const bookHtml = `
                    <div class="col-lg-4 col-xl-4 col-md-6 col-sm-12 p-1">
                        <div class="book-card bg-light rounded py-1 m-1">
                             <div class="card-header rounded-top overflow-hidden d-flex justify-content-center">
                            <video src="./img/book.mp4" autoplay="autoplay" loop="loop" class="img-fluid rounded-top w-75"></video>
                        </div>
                            <div class="d-flex flex-column p-2 pb-0">
                                <h6 href="#" class="h6">${book.name}</h6>
                                <br>
                                <div class="justify-content-between">
                                    <a href="#" class="small text-body link-hover"><i class="fa fa-user"></i> ${book.author}</a>
                                    <small class="text-body d-block"><i class="fas fa-calendar-alt me-1"></i> ${book.publisher}</small>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <button  onclick="handleDownload({id: '${book.id}'})"  class="small text-body link-hover  border-0 "><i class="fa fa-download"></i> yuklab olish</a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                    booksContainer.innerHTML += bookHtml;
                });
            } catch (error) {
                console.error("Error fetching books:", error);
            }
        }

        // Initialize Owl Carousel
        function initializeOwlCarousel() {
            const owl = $(".latest-news-carousel");
            owl.owlCarousel("destroy"); // Destroy any previous instance
            owl.owlCarousel({
                loop: true,
                margin: 25,
                nav: true,
                dots: true,
                navText: [
                    '<i class="fas fa-chevron-left"></i>',
                    '<i class="fas fa-chevron-right"></i>'
                ],
                autoplay: true, // Enable autoplay
                autoplayTimeout: 1000, // Set autoplay interval to 1 second (1000 ms)
                autoplayHoverPause: true, // Pause on hover
                smartSpeed: 600,
                responsive: {
                    200: { items: 1 },
                    800: { items: 4 },
                    1200: { items: 4 }
                }
            });
        }

        // Initial fetch
        fetchAndRenderFaculties();

    </script>

    <!-- Badiiy -->
    <script>
        let currentPageBadiiy = 0;
        const pageSizeBadiiy = 10;

        // Function to fetch books and handle search
        async function fetchNewspapers(page = 0, bookName = '', authorName = '') {
            try {
                const response = await axios.get(baseUrl + `/api/v1/book/badiiy`, {
                    headers: {
                        Authorization: `Bearer ${localStorage.getItem("access_token") || ""}`
                    },
                    params: {
                        page: page,
                        size: pageSizeBadiiy,
                        title: bookName,
                        author: authorName
                    }
                });

                const jurnalDiv = document.getElementById("badiiy");
                jurnalDiv.innerHTML = ""; // Clear previous items

                // Render books
                response.data.content.forEach((item) => {
                    const newspaperHTML = `
                <div class="my-2 latest-news-item col-lg-3 col-xl-3 col-md-4 col-sm-12">
                    <div class="card-container bg-light rounded">
                        <div class="card-header rounded-top overflow-hidden d-flex justify-content-center">
                            <video src="./img/book.mp4" autoplay="autoplay" loop="loop" class="img-fluid rounded-top w-75"></video>
                        </div>
                        <div class="card-body d-flex flex-column p-4">
                            <h6 class="h6">${item?.name}</h6>
                            <div class="d-flex justify-content-between">
                                <span onclick="handleDownloadNewspaper(${item.id})" class="small text-body link-hover">
                                    <i class="fa fa-download"></i> Yuklab olish
                                </span>
                                <small class="text-body d-block">
                                    <i class="fas fa-calendar-alt me-1"></i> ${item?.author || ""}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>`;
                    jurnalDiv.innerHTML += newspaperHTML;
                });

                renderPaginationControlsBadiiy(response.data.totalPages, page); // Render pagination
            } catch (error) {
                console.error("Error fetching newspapers:", error.response || error.message);
            }
        }

        // Function to render pagination buttons
        function renderPaginationControlsBadiiy(totalPages, currentPage) {
            const paginationDiv = document.getElementById("badiiy-pagination");
            paginationDiv.innerHTML = ""; // Clear existing buttons

            for (let i = 0; i < totalPages; i++) {
                const button = document.createElement("button");
                button.textContent = i + 1; // Page numbers start at 1
                button.className = `btn btn-sm mx-1 ${i === currentPage ? "btn-primary" : "btn-light"}`;

                // Handle button click
                button.addEventListener("click", () => {
                    currentPageBadiiy = i; // Update current page
                    const bookName = document.getElementById('book-name-search').value.toLowerCase();
                    const authorName = document.getElementById('book-author-search').value.toLowerCase();
                    fetchNewspapers(i, bookName, authorName); // Fetch data for the selected page
                });

                paginationDiv.appendChild(button);
            }
        }

        // Function to handle search input and trigger fetching books
        function searchBooks() {
            const bookName = document.getElementById('book-name-search').value.toLowerCase();
            const authorName = document.getElementById('book-author-search').value.toLowerCase();
            fetchNewspapers(currentPageBadiiy, bookName, authorName);
        }

        // Initial call to fetch books
        fetchNewspapers(currentPageBadiiy);
    </script>


    <!-- Audio -->
    <script>
        let currentPageAudio = 0;
        const pageSizeAudio = 10;

        // Function to fetch books and handle search
        async function fetchAudio(page = 0, bookName = '', authorName = '') {
            console.log(bookName)
            try {
                const response = await axios.get(baseUrl + `/api/v1/book/audio`, {
                    headers: {
                        Authorization: `Bearer ${localStorage.getItem("access_token") || ""}`
                    },
                    params: {
                        page: page,
                        size: pageSizeAudio,
                        title: bookName,
                        author: authorName
                    }
                });

                const AudioDiv = document.getElementById("audio");
                AudioDiv.innerHTML = ""; // Clear previous items

                // Render books
                response.data.content.forEach((item) => {
                    const AudioHTML = `
                <div class="my-2 latest-news-item col-lg-3 col-xl-3 col-md-4 col-sm-12">
                    <div class="card-container bg-light rounded">
                        <div class="card-header rounded-top overflow-hidden d-flex justify-content-center">
                            <video src="./img/audio.mp4" autoplay loop class="img-fluid rounded-top w-75"></video>
                        </div>
                        <div class="card-body d-flex flex-column p-4">
                            <h6 class="h6">${item?.name}</h6>
                            <div class="d-flex justify-content-between">
                                <span onclick="handleDownloadAudio(${item.id})" class="small text-body link-hover">
                                    <i class="fa fa-download"></i> Yuklab olish
                                </span>
                                <small class="text-body d-block">
                                    <i class="fas fa-calendar-alt me-1"></i> ${item?.author || ""}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>`;
                    AudioDiv.innerHTML += AudioHTML;
                });

                renderPaginationControlsAudio(response.data.totalPages, page); // Render pagination
            } catch (error) {
                console.error("Error fetching newspapers:", error.response || error.message);
            }
        }

        // Function to render pagination buttons
        function renderPaginationControlsAudio(totalPages, currentPage) {
            const paginationDiv = document.getElementById("audio-pagination");
            paginationDiv.innerHTML = ""; // Clear existing buttons

            for (let i = 0; i < totalPages; i++) {
                const button = document.createElement("button");
                button.textContent = i + 1; // Page numbers start at 1
                button.className = `btn btn-sm mx-1 ${i === currentPage ? "btn-primary" : "btn-light"}`;

                // Handle button click
                button.addEventListener("click", () => {
                    currentPageAudio = i; // Update current page
                    const bookName = document.getElementById('audio-name-search').value.toLowerCase();
                    const authorName = document.getElementById('audio-author-search').value.toLowerCase();
                    fetchAudio(i, bookName, authorName); // Fetch data for the selected page
                });

                paginationDiv.appendChild(button);
            }
        }

        // Function to handle search input and trigger fetching books
        function searchAudioBooks() {
            const bookName = document.getElementById('audio-name-search').value.toLowerCase();
            const authorName = document.getElementById('audio-author-search').value.toLowerCase();
            console.log(bookName)
            fetchAudio(currentPageAudio, bookName, authorName);
        }

        // Initial call to fetch books
        fetchAudio(currentPageAudio);
    </script>
    <!--download audio-->
    <script>
        // Function to handle audio download
        async function handleDownloadAudio(audio) {
            console.log("Attempting to download audio:", audio);
            const studentToken = localStorage.getItem("student_token");
            console.log("Retrieved token:", studentToken);

            if (!studentToken) {
                openLoginModal();
                return;
            }



        }
        function openLoginModal() {
            const loginModal = new bootstrap.Modal(document.getElementById("searchModal"), {
                backdrop: "static",
                keyboard: false,
            });
            loginModal.show();
        }

        // Function to handle login form submission
        const handleStudentSubmit = async (e) => {
            e.preventDefault();
            localStorage.clear();
            const studentLogin = document.getElementById("studentLogin").value;
            const studentPassword = document.getElementById("studentPassword").value;

            try {
                const response = await axios.post("https://student.buxpxti.uz/rest/v1/auth/login", {
                    login: studentLogin,
                    password: studentPassword,
                });
                console.log(response.data);
                const token = response?.data?.data?.token;
                if (token) {
                    console.log("Login successful. Saving token to localStorage.");
                    localStorage.setItem("student_token", token);
                    const searchModal = bootstrap.Modal.getInstance(document.getElementById("searchModal"));
                    searchModal.hide();
                } else {
                    console.error("Token not found in response data.");
                    alert("Login failed: Unable to retrieve token.");
                }
            } catch (error) {
                console.error("Login error:", error);
                alert("Login failed. Please check your credentials and try again.");
            }
        };

        // Attach the login submission handler to the form
        document
            .getElementById("studentLoginForm")
            ?.addEventListener("submit", handleStudentSubmit);
    </script>



    <!--all boks -->
    <script>
        let currentPage = 0; // Start from the first page
        const pageSize = 10; // Number of items per page
        let bookFilters = {
            title: "",
            author: "",
            publisher: ""
        };

        // Fetch and render books
        async function fetchAndRenderBooks() {
            try {
                const { title, author, publisher } = bookFilters;
                const response = await axios.get(`${baseUrl}/api/v1/book/search`, {
                    params: {
                        title: title || null,
                        author: author || null,
                        publisher: publisher || null,
                        page: currentPage,
                        size: pageSize
                    },
                    headers: {
                        Authorization: localStorage.getItem("access_token") || ""
                    }
                });

                const books = response.data.content; // Paginated books
                const totalPages = response.data.totalPages;

                // Render books in the table
                const booksTableBody = document.querySelector("table tbody");
                booksTableBody.innerHTML = "";

                if (books.length === 0) {
                    booksTableBody.innerHTML = `<tr><td colspan="5" class="text-center">No books found</td></tr>`;
                    return;
                }

                books.forEach((book, index) => {
                    const bookRow = `
                    <tr>
                        <td>${currentPage * pageSize + index + 1}</td>
                        <td>${book.name}</td>
                        <td>${book.author}</td>
                        <td>${book.publisher}</td>
                        <td>${book.subject?.name || 'N/A'}</td>
                         <td onclick="handleDownload({id: '${book.id}'})" class="d-flex align-items-center gap-2 ">
                                    <i class="fa fa-download" ></i> yuklab olish
                                </td>
                    </tr>
                `;
                    booksTableBody.innerHTML += bookRow;
                });

                // Render pagination controls
                renderPaginationControls(totalPages);
            } catch (error) {
                console.error("Error fetching books:", error);
            }
        }

        // Render pagination controls
        function renderPaginationControls(totalPages) {
            const paginationContainer = document.getElementById("pagination-controls");
            if (!paginationContainer) return;

            paginationContainer.innerHTML = "";

            // Кнопка "<< назад на 5"
            if (currentPage - 5 >= 0) {
                paginationContainer.innerHTML += `
            <button class="btn btn-light mx-1" onclick="goToPage(${currentPage - 5})">
                &laquo;
            </button>`;
            }

            // Кнопка "< назад на 1"
            if (currentPage > 0) {
                paginationContainer.innerHTML += `
            <button class="btn btn-light mx-1" onclick="goToPage(${currentPage - 1})">
                &lsaquo;
            </button>`;
            }

            // Текущая страница и ближайшие ±2
            const start = Math.max(0, currentPage - 2);
            const end = Math.min(totalPages - 1, currentPage + 2);

            for (let page = start; page <= end; page++) {
                const isActive = page === currentPage;
                paginationContainer.innerHTML += `
            <button class="btn ${isActive ? "btn-primary" : "btn-light"} mx-1"
                    onclick="goToPage(${page})">
                ${page + 1}
            </button>`;
            }

            // Кнопка "> вперёд на 1"
            if (currentPage < totalPages - 1) {
                paginationContainer.innerHTML += `
            <button class="btn btn-light mx-1" onclick="goToPage(${currentPage + 1})">
                &rsaquo;
            </button>`;
            }

            // Кнопка ">> вперёд на 5"
            if (currentPage + 5 < totalPages) {
                paginationContainer.innerHTML += `
            <button class="btn btn-light mx-1" onclick="goToPage(${currentPage + 5})">
                &raquo;
            </button>`;
            }
        }



        // Go to a specific page
        function goToPage(page) {
            currentPage = page;
            fetchAndRenderBooks();
        }

        // Update filters and re-fetch books
        function updateFilters() {
            bookFilters.title = document.getElementById("book-name").value;
            bookFilters.author = document.getElementById("book-author").value;
            bookFilters.publisher = document.getElementById("book-publisher").value;

            currentPage = 0; // Reset to the first page when filters change
            fetchAndRenderBooks();
        }

        // Add event listeners for input changes
        document.getElementById("book-name").addEventListener("input", updateFilters);
        document.getElementById("book-author").addEventListener("input", updateFilters);
        document.getElementById("book-publisher").addEventListener("input", updateFilters);

        // Fetch books on page load
        fetchAndRenderBooks();

    </script>

    <!--download books-->
    <!-- Download Books Script -->
    <script>

        // Function to handle book download
        async function handleDownload(book) {
            console.log("Attempting to download book:", book);

            const studentToken = localStorage.getItem("student_token");
            console.log("Retrieved token:", studentToken);

            if (!studentToken) {
                openLoginModal();
                return;
            }

            try {
                const validationResponse = await fetch("https://student.buxpxti.uz/rest/v1/account/me", {
                    method: "GET",
                    headers: {
                        Authorization: `Bearer ${studentToken}`,
                    },
                });

                if (validationResponse.status !== 200) {
                    console.log("Token validation failed. Clearing token and opening login modal.");
                    localStorage.removeItem("student_token");
                    openLoginModal();
                    return;
                }
                const response = await fetch(`${baseUrl}/api/v1/book/getFile/${book.id}`, {
                    method: "GET",
                    headers: {
                        Authorization: `Bearer ${studentToken}`,
                    },
                });

                if (!response.ok) {
                    throw new Error("Failed to download file. Please try again.");
                }

                const blob = await response.blob();
                const downloadUrl = window.URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.href = downloadUrl;
                link.setAttribute("download", `${book.title || "file"}.pdf`);
                document.body.appendChild(link);
                link.click();
                link.remove();
                window.URL.revokeObjectURL(downloadUrl);
            } catch (error) {
                console.error("Error downloading file:", error);
                alert("Error downloading the file. Please try again.");
            }
        }


        async function handleDownloadNewspaper(id) {
            console.log("Attempting to download book:", id);

            const studentToken = localStorage.getItem("student_token");
            console.log("Retrieved token:", studentToken);

            if (!studentToken) {
                openLoginModal();
                return;
            }

            try {
                const validationResponse = await fetch("https://student.buxpxti.uz/rest/v1/account/me", {
                    method: "GET",
                    headers: {
                        Authorization: `Bearer ${studentToken}`,
                    },
                });

                if (validationResponse.status !== 200) {
                    console.log("Token validation failed. Clearing token and opening login modal.");
                    localStorage.removeItem("student_token");
                    openLoginModal();
                    return;
                }
                const response = await fetch(`${baseUrl}/api/v1/book/getFile/badiiy/${id}`, {
                    method: "GET",
                    headers: {
                        Authorization: `Bearer ${studentToken}`,
                    },
                });

                if (!response.ok) {
                    throw new Error("Failed to download file. Please try again.");
                }

                const blob = await response.blob();
                const downloadUrl = window.URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.href = downloadUrl;
                link.setAttribute("download", `badiiy adabiyot.pdf`);
                document.body.appendChild(link);
                link.click();
                link.remove();
                window.URL.revokeObjectURL(downloadUrl);
            } catch (error) {
                console.error("Error downloading file:", error);
                alert("Error downloading the file. Please try again.");
            }
        }

        // Open the login modal
        function openLoginModal() {
            const loginModal = new bootstrap.Modal(document.getElementById("searchModal"), {
                backdrop: "static",
                keyboard: false,
            });
            loginModal.show();
        }


        // Attach the login submission handler to the form
        document
            .getElementById("studentLoginForm")
            ?.addEventListener("submit", handleStudentSubmit);
    </script>

    <!--login -->
    <script>


    </script>


</body>

</html>